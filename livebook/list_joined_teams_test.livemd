# チームに所属検証

## Section

```elixir
defmodule Test do
  import Ecto.Query, warn: false
  alias Bright.Repo

  alias Bright.Teams.Team
  alias Bright.Accounts.UserNotifier
  alias Bright.SkillScores.SkillClassScore
  alias Bright.Teams.TeamMemberUsers

  def joined_teams_by_user_id_and_user_name!(user_id, other_user_name) do
    from(tmbu in TeamMemberUsers,
      join: t in assoc(tmbu, :team),
      join: m in assoc(t, :member_users),
      join: u in assoc(m, :user),
      where:
        tmbu.user_id == ^user_id and not is_nil(tmbu.invitation_confirmed_at) and
          u.name == ^other_user_name,
      select: u.name,
      distinct: true
    )
    # |> preload(team: [member_users: :user])
    # |> Repo.all()
    |> Repo.one!()
  end
end

user = Bright.Accounts.get_user_by_name("ymn")

Test.joined_teams_by_user_id_and_user_name!(user.id, "ymn2")
```
