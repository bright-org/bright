# ジェムの表示仕様

各画面のジェムの表示仕様を整理しています。


## 全体共通

- ジェム１角が0の場合もレーダーチャート上の0は見た目が悪いため、小さく表示する。


## 1. スキルバランス

１角がキャリアフィールドになるジェムです。

#### 仕様概要

- 絶対表示ではなく、そのユーザーのスキル取得状況の相対（バランス）で表示する
  - その人の属性がどこに寄っているかを示す
- ロジックは次の通り
  - 各キャリアフィールドで、習得率(*1)を計算する
    - (*1) 保有スキルパネルの獲得スキル数 / 保有スキルパネルのスキル数
    - 保有スキルパネルとは、キャリアフィールドに紐づいているものを対象とする
      - エンジニアのスキルパネルに、デザイナーとの共通スキルがあっても無視する(*2)
        - (*2) デザイナーのスキルパネルを取得していなければ0%
        - これは母数が小さいキャリアフィールドが100%判定されるのを防止するため
  - 習得率が最も大きいキャリアフィールドを100%として他を相対化する
    - 必ず1つのキャリアフィールドが100%になる（少なくとも1つスキルパネルを保持しているとき）
    - `エンジニア: 0.2, デザイナー: 0.1, マーケッター: 0.05` であれば、 `エンジニア: 100%, デザイナー: 0.1/0.2 = 50%, マーケッター: 0.05/0.2 = 25%`となる

#### 更新タイミング

- バッチ処理
  - 画面でスキルスコアを更新したタイミングでは行わない
    - 処理時間がかかるため
  - 日に一回実行する
  - 手動実行メモ
    - `Bright.Batches.update_career_field_scores()`

#### データソース

- career_field_scores
  - career_fieldごとのuserのパーセンテージと取得スキル数を保持

#### 表示画面

- マイページ
- 成長パネル


## 2. キャリアフィールドジェム

スキルバランスの１角（＝キャリアフィールド）指定時のジェムです。
例えば「エンジニア」を選んだときに表示されます。

- ジョブ階層 基本・応用・高度 がそれぞれ１角の３角形

補足
- 成長パネルで、キャリアフィールドを指定時のみ表示される
- キャリアフィールドのジョブを全て並べると、エンジニアでは30個を超すのでそれぞれを１角にするのは妥当ではない

#### 更新タイミング

- TODO: 未確定です。

#### データソース

- TODO: 未確定です。更新タイミングに依存。

#### 表示画面

- 成長パネル


## 3. スキルジェム

１角がスキルユニットになるジェムです。

#### 仕様概要

- スキルユニットごとの習得率の絶対表示

#### 更新タイミング

- スキルスコア更新時
- スキルパネル更新処理

#### データ元

- skill_unit_scores

#### 表示画面

- 成長パネル
- チームスキル分析


## その他

（１）スキルパネルが画面で選択されていないときの成長グラフ表示仕様

- 100% is 何になるので、相対化した数値で表示する
- 右上Maxに接している折れ線が必ず存在する
  - 未来地点がMaxになる
- 比較対象がいれば、相手Maxと自分Maxの大きい方をとる

